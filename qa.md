- 看了下MySQL分区相关问题
- 调试pintaram，thinkPHP的debug模式试了好久，怎么都打不开- -
- 数据库开启慢查询，分析慢查询日志

分析结论：502bad gateway通常与nginx无关，应该是服务端也就是php-cgi或者php-fpm的问题，产生原因十有八九是因为mysql查询太慢，某些查询能耗时30秒甚至近1min，会导致超时返回502. 目前，先不解决服务问题，先从mysql慢查询下手，优化后再看，如果还有问题，再看其他。
分析慢查询语句发现索引以及分区都用上了，查询应该问题不大，明天再看看这些语句，如果没什么问题，调整数据库配置试一下，给MySQL服务增加资源。